<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WE-APP - Admin Panel</title>
  <!-- Bootstrap 5.3.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; padding-top: 4rem; }
    .navbar-brand { font-weight: bold; }

    /* شكل موحّد للأزرار */
    .nav-btn {
      background: transparent; 
      border: 0;
      border-radius: .7rem;
      padding: .45rem .6rem;
      color: rgba(255,255,255,0.65); /* أبيض شفاف */
      transition: color 0.2s ease;
    }
    .nav-btn:hover {
      color: #ffffff; /* عند المرور يصبح أبيض صافي */
    }

    /* الأيقونة النشطة */
    .nav-btn.active-icon {
      color: #ffffff !important; /* أبيض كامل */
    }

    /* شارة اسم المستخدم */
    .username-pill {
      background: #ffffff;
      color: #0d6efd;
      border-radius: 999px;
      padding: .35rem .75rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      max-width: 220px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .username-pill i { color: #0d6efd; }
    @media (max-width: 480px){
      .username-pill { max-width: 140px; }
    }
  </style>
</head>
<body>

{% set ep = (request.endpoint or '') %}
{% set ap = active_page or '' %}

<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ url_for('newadmin.admin_dashboard') }}">WE-APP - Admin Panel</a>

    <div class="d-flex align-items-center gap-2 ms-auto">

      {% if session.get('admin_logged_in') %}
        <!-- اسم المستخدم -->
        <span class="username-pill" title="{{ session.get('admin_user','') }}">
          <i class="bi bi-person-circle"></i>
          <span class="text-truncate">{{ session.get('admin_user','') }}</span>
        </span>

        <!-- تغيير كلمة المرور -->
        <a href="{{ url_for('admin_change_password') }}"
           class="btn nav-btn {% if ep=='admin_change_password' or ap=='change_password' %}active-icon{% endif %}"
           title="Change Password" aria-label="Change Password">
          <i class="bi bi-key"></i>
        </a>
      {% endif %}

      <!-- Dashboard -->
      <a href="{{ url_for('newadmin.admin_dashboard') }}"
         class="btn nav-btn {% if ep=='newadmin.admin_dashboard' or ap=='dashboard' %}active-icon{% endif %}"
         title="Dashboard" aria-label="Dashboard">
        <i class="bi bi-house"></i>
      </a>

      {% if session.get('admin_logged_in') %}
        <!-- Users -->
        <a href="{{ url_for('newadmin.newadmin_page') }}"
           class="btn nav-btn {% if ep=='newadmin.newadmin_page' or ap=='users' %}active-icon{% endif %}"
           title="Users" aria-label="Users">
          <i class="bi bi-people"></i>
        </a>

        {% if (session.get('admin_role') or '').strip().lower() == 'super' %}
          <!-- Manage Admins -->
          <a href="{{ url_for('admin_manage') }}"
             class="btn nav-btn {% if ep=='admin_manage' or ap=='admins' %}active-icon{% endif %}"
             title="Manage Admins" aria-label="Manage Admins">
            <i class="bi bi-person-gear"></i>
          </a>

          <!-- Add Admin -->
          <a href="{{ url_for('newadmin.admin_add') }}"
             class="btn nav-btn {% if ep=='newadmin.admin_add' or ap=='add_admin' %}active-icon{% endif %}"
             title="Add Admin" aria-label="Add Admin">
            <i class="bi bi-person-plus"></i>
          </a>
        {% endif %}

        <!-- Activity Logs -->
        <a href="{{ url_for('admin_logs') }}"
           class="btn nav-btn {% if ep=='admin_logs' or ap=='logs' %}active-icon{% endif %}"
           title="Activity Logs" aria-label="Activity Logs">
          <i class="bi bi-list-check"></i>
        </a>

        <!-- Logout -->
        <a href="{{ url_for('logout') }}" class="btn nav-btn" title="Logout" aria-label="Logout">
          <i class="bi bi-box-arrow-right"></i>
        </a>
      {% endif %}
    </div>
  </div>
</nav>

<div class="container mt-4">
  {% block content %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
