<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WE-APP - Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; padding-top: 4rem; }
    .navbar-brand { font-weight: bold; }

    /* شكل موحّد للأزرار */
    .nav-btn { background:#fff; border:0; border-radius:.7rem; padding:.45rem .6rem; }

    /* شارة اسم المستخدم */
    .username-pill {
      background: #ffffff;
      color: #0d6efd;
      border-radius: 999px;
      padding: .35rem .75rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      max-width: 220px;             /* لمنع كسر الشريط */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .username-pill i { color: #0d6efd; }
    @media (max-width: 480px){
      .username-pill { max-width: 140px; }
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ url_for('newadmin.admin_dashboard') }}">WE-APP - Admin Panel</a>

    <div class="d-flex align-items-center gap-2 ms-auto">

      {% if session.get('admin_logged_in') %}
        <!-- اسم المستخدم (قبل زر Home) -->
        <span class="username-pill" title="{{ session.get('admin_user','') }}">
          <i class="bi bi-person-circle"></i>
          <span class="text-truncate">{{ session.get('admin_user','') }}</span>
        </span>

        <!-- زر تغيير كلمة المرور (🔑) -->
        <a href="{{ url_for('admin_change_password') }}" class="btn nav-btn" title="Change Password" aria-label="Change Password">
          <i class="bi bi-key"></i>
        </a>
      {% endif %}

      <!-- Home (داشبورد) -->
      <a href="{{ url_for('newadmin.admin_dashboard') }}" class="btn nav-btn" title="Dashboard" aria-label="Dashboard">
        <i class="bi bi-house"></i>
      </a>

      {% if session.get('admin_logged_in') %}
        <!-- Users (متاحة لكل الأدوار) -->
        <a href="{{ url_for('newadmin.newadmin_page') }}" class="btn nav-btn" title="Users" aria-label="Users">
          <i class="bi bi-people"></i>
        </a>

        {% if (session.get('admin_role') or '').strip().lower() == 'super' %}
          <!-- Manage Admins (Super فقط) -->
          <a href="{{ url_for('admin_manage') }}" class="btn nav-btn" title="Manage Admins" aria-label="Manage Admins">
            <i class="bi bi-person-gear"></i>
          </a>

          <!-- Add Admin (Super فقط) -->
          <a href="{{ url_for('newadmin.admin_add') }}" class="btn nav-btn" title="Add Admin" aria-label="Add Admin">
            <i class="bi bi-person-plus"></i>
          </a>
        {% endif %}

        <!-- Logout (آخر زر) -->
        <a href="{{ url_for('logout') }}" class="btn nav-btn" title="Logout" aria-label="Logout">
          <i class="bi bi-box-arrow-right"></i>
        </a>
      {% endif %}
    </div>
  </div>
</nav>

<div class="container mt-4">
  {% block content %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
